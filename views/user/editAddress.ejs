<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Address management</title>
    
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
     <link rel="stylesheet" href="/assets/user-style/address.css">
      <link rel="stylesheet" href="/assets/user-style/sidebar.css">
    <link
      rel="shortcut icon"
      type="image/x-icon"s
      href="assets/img/favicon.ico"
    />
   
  </head>
  <body>
    <%- include('../partials/user/header')%>
       <input type="checkbox" id="sidebar-toggle" />
    <label for="sidebar-toggle" class="sidebar-toggle-label">â˜°</label>

    <aside class="sidebar">
      <nav>
        <ul class="sidebar-menu">
          <li><a href="/userProfile" >Account Overview</a></li>
          <li><a href="/orders" >Order Details</a></li>
          <li><a href="/addressManagement" class="active">Manage Address</a></li>
          <li><a href="/wallet">Wallet</a></li>
          <li><a href="/password">Password</a></li>
          <li><a href="/wishlist">Wishlist</a></li>
        </ul>
      </nav>
      <button class="logout-btn">Logout</button>
    </aside>
  
 
     <main class="content">
  <!-- Page Content -->
  <div class="view-port">
   
    <div class="overview-grid">
     
      <!-- Address Details Section -->
      <div class="overview-card" id="address-details">
            <h3>Edit Address</h3>
            <form action="/updateAddress?id=<%= address._id %>" method="POST">
                <div class="form-row">
                    <div class="form-group">
                        <label for="addressType">Address Type:</label>
                        <input type="text" id="addressType" name="addressType" value="<%=address.addressType%>" required>
                    </div>
                    <div class="form-group">
                        <label for="name">Name:</label>
                        <input type="text" id="name" name="name" value="<%=address.name %>" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="city">City:</label>
                        <input type="text" id="city" name="city" value="<%=address.city %>" required>
                    </div>
                    <div class="form-group">
                        <label for="landmark">Landmark:</label>
                        <input type="text" id="landmark" name="landmark" value="<%=address.landmark %>">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="district">District:</label>
                        <input type="text" id="district" name="district" value="<%=address.district %>" required>
                    </div>
                    <div class="form-group">
                        <label for="state">State:</label>
                        <input type="text" id="state" name="state" value="<%=address.state %>" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="pincode">Pincode:</label>
                        <input type="text" id="pincode" name="pincode" value="<%= address.pincode %>" 
                               required pattern="\d{6}" title="Pincode must be 6 digits">
                    </div>
                    <div class="form-group">
                        <label for="phone">Phone:</label>
                        <input type="tel" id="phone" name="phone" value="<%= address.phone %>" 
                               required pattern="\d{10}" title="Phone number must be 10 digits">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="alternativePhone">Alternative Phone:</label>
                        <input type="tel" id="alternativePhone" name="alternativePhone" 
                               value="<%= address.alternativePhone %>" pattern="\d{10}">
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="submit-btn">Update Address</button>
                    <a href="/addressManagement" class="cancel-btn">Cancel</a>
                </div>
            </form>
        </div>
    </main>
    </div>

  
     </div>
    <%- include('../partials/user/footer')%>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
   
     <script>
        // Add confirmation for delete address
        document.querySelectorAll('.delete-address-btn').forEach(button => {
            button.addEventListener('click', async (e) => {
                e.preventDefault();
                const href = e.currentTarget.querySelector('a').getAttribute('href');

                const result = await Swal.fire({
                    title: 'Are you sure?',
                    text: "You won't be able to revert this!",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Yes, delete it!'
                });

                if (result.isConfirmed) {
                    window.location.href = href;
                }
            });
        });

        // Form validation and success/error messages
        document.querySelector('form').addEventListener('submit', function(e) {
            if (!this.checkValidity()) {
                e.preventDefault();
                Swal.fire({
                    icon: 'error',
                    title: 'Validation Error',
                    text: 'Please check all required fields'
                });
            }
        });
    </script>
    



